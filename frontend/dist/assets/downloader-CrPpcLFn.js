import{j as e,B as p,o as f,h as C,t as g,r as v,A as b,s as t}from"./index-B01K6LtN.js";import{C as K}from"./content-section-BecwT8tS.js";import{C as Q,c as z}from"./card-C8S_LLSC.js";import{S as M}from"./scroll-area-QD9Lh6Qq.js";import{T as P,a as W,b as A,c as L}from"./tabs-BzFi7Z-H.js";import{u as S,F as D,a as c,b as m,c as d,d as u,e as h}from"./form-CxRSSxqG.js";import{a as F}from"./zod-C1KCSxpg.js";import{u as q}from"./useQuery-DrhposrY.js";import{u as T}from"./useMutation-DrK_Az29.js";import{p as N,g as E}from"./config-DY6TxoJ-.js";import{I as x}from"./input-c0Q4JQol.js";import{T as U,P as V}from"./trash-2-DsQGbZ5q.js";import{S as I}from"./save-BkRvdnS9.js";import{D as k}from"./download-B99peeGY.js";import"./index-WrHNe2I8.js";import"./index-BdQq_4o_.js";import"./index-BWB9MiGf.js";import"./index-C2uM0dkt.js";import"./request-2_miQ1pQ.js";import"./createLucideIcon-CCBfe0vc.js";const w=[{id:"qbittorrent",name:"qBittorrent"},{id:"transmission",name:"Transmission"},{id:"clouddrive",name:"CloudDrive"},{id:"thunder",name:"迅雷"}];function _({value:n,onChange:r}){const a=()=>r([...n,{label:"",path:""}]),o=(s,i,l)=>{r(n.map((y,B)=>B==s?{...y,[i]:l}:y))},j=s=>{r(n.filter((i,l)=>l!==s))};return e.jsxs("div",{className:"space-y-2",children:[n.map((s,i)=>e.jsxs("div",{className:"grid grid-cols-11 gap-2",children:[e.jsx(x,{className:"col-span-5",placeholder:"名称（如：电影）",value:s.label,onChange:l=>o(i,"label",l.target.value)}),e.jsx(x,{className:"col-span-5",placeholder:"/downloads/movie,fileid",value:s.path,onChange:l=>o(i,"path",l.target.value)}),e.jsx(p,{size:"icon",variant:"ghost",className:"text-destructive",onClick:()=>j(i),children:e.jsx(U,{})})]},i)),e.jsxs(p,{variant:"outline",onClick:a,children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),"添加目录"]})]})}const O=f({url:t().min(1,"输入地址"),username:t().min(1,"输入用户名"),password:t().min(1,"输入密码"),save_paths:b(f({path:t().min(1,"输入保存地址"),label:t().min(1,"输入保存地址别名")}))});function R({downloaderId:n}){const r=S({resolver:F(O),defaultValues:{url:"",username:"",password:"",save_paths:[]}}),a=C(),{data:o}=q({queryKey:["downloader",n],queryFn:async()=>(await E("Downloader."+n)).data,staleTime:300*1e3}),j=T({mutationFn:async s=>await N("Downloader."+n,s),onSuccess:s=>{g.success(s.message),a.invalidateQueries({queryKey:["downloader",n]}),a.invalidateQueries({queryKey:["downloaders"]})}});return v.useEffect(()=>{o&&r.reset(o)},[o,r]),e.jsx(D,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(s=>j.mutate(s)),className:"max-w-md space-y-4",children:[e.jsx(c,{control:r.control,name:"url",render:({field:s})=>e.jsxs(m,{children:[e.jsx(d,{children:"WEB UI地址"}),e.jsx(u,{children:e.jsx(x,{placeholder:"输入WEB UI地址",...s})}),e.jsx(h,{})]})}),e.jsx(c,{control:r.control,name:"username",render:({field:s})=>e.jsxs(m,{children:[e.jsx(d,{children:"用户名"}),e.jsx(u,{children:e.jsx(x,{placeholder:"输入用户名",...s})}),e.jsx(h,{})]})}),e.jsx(c,{control:r.control,name:"password",render:({field:s})=>e.jsxs(m,{children:[e.jsx(d,{children:"密码"}),e.jsx(u,{children:e.jsx(x,{type:"password",placeholder:"输入登录密码",...s})}),e.jsx(h,{})]})}),e.jsx(c,{control:r.control,name:"save_paths",render:({field:s})=>e.jsxs(m,{children:[e.jsx(d,{children:"保存目录"}),e.jsx(u,{children:e.jsx(_,{value:s.value,onChange:s.onChange})}),e.jsx(h,{})]})}),e.jsxs(p,{type:"submit",children:[e.jsx(I,{}),"保存配置"]})]})})}const G=f({url:t().min(1,"输入地址"),authorization:t(),save_paths:b(f({path:t().min(1,"输入保存地址"),label:t().min(1,"输入保存地址别名")}))});function H({downloaderId:n}){const r=S({resolver:F(G),defaultValues:{url:"",authorization:"",save_paths:[]}}),a=C(),{data:o}=q({queryKey:["downloader",n],queryFn:async()=>(await E("Downloader."+n)).data,staleTime:300*1e3}),j=T({mutationFn:async s=>await N("Downloader."+n,s),onSuccess:s=>{g.success(s.message),a.invalidateQueries({queryKey:["downloader",n]}),a.invalidateQueries({queryKey:["downloaders"]})}});return v.useEffect(()=>{o&&r.reset(o)},[o,r]),e.jsx(D,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(s=>j.mutate(s)),className:"max-w-md space-y-4",children:[e.jsx(c,{control:r.control,name:"url",render:({field:s})=>e.jsxs(m,{children:[e.jsx(d,{children:"WEB UI地址"}),e.jsx(u,{children:e.jsx(x,{placeholder:"输入WEB UI地址",...s})}),e.jsx(h,{})]})}),e.jsx(c,{control:r.control,name:"authorization",render:({field:s})=>e.jsxs(m,{children:[e.jsx(d,{children:"请求头"}),e.jsx(u,{children:e.jsx(x,{placeholder:"输入请求头",...s})}),e.jsx(h,{})]})}),e.jsx(c,{control:r.control,name:"save_paths",render:({field:s})=>e.jsxs(m,{children:[e.jsx(d,{children:"保存目录ID"}),e.jsx(u,{children:e.jsx(_,{value:s.value,onChange:s.onChange})}),e.jsx(h,{})]})}),e.jsxs(p,{type:"submit",children:[e.jsx(I,{}),"保存配置"]})]})})}function J(){const[n,r]=v.useState("qbittorrent");return e.jsxs(P,{value:n,onValueChange:r,className:"w-full",children:[e.jsx(M,{orientation:"horizontal",type:"hover",className:"w-full",children:e.jsx(W,{children:w.map(a=>e.jsx(A,{value:a.id,children:a.name},a.id))})}),w.map(a=>e.jsx(L,{value:a.id,children:e.jsx(Q,{children:e.jsx(z,{children:a.id==="thunder"?e.jsx(H,{downloaderId:a.id}):e.jsx(R,{downloaderId:a.id},a.id)})})},a.id))]})}function X(){return e.jsx(K,{title:"下载器",desc:"配置下载器的连接信息，以及预设下载目录",icon:e.jsx(k,{className:"h-5 w-5 text-primary"}),children:e.jsx(J,{})})}const fe=X;export{fe as component};
