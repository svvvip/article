import{r as m,b as F,d as L,o as k,j as s,c as S,L as d,B as v,s as l,t as u,e as I}from"./index-B01K6LtN.js";import{C as w,a as y,b as A,d as P,c as E}from"./card-C8S_LLSC.js";import{A as M}from"./auth-layout-CYtkX4B1.js";import{u as _,F as B,a as p,b as h,c as x,d as j,e as f}from"./form-CxRSSxqG.js";import{a as H}from"./zod-C1KCSxpg.js";import{l as T}from"./user-CRSCMw9j.js";import{I as D}from"./input-c0Q4JQol.js";import{P as R}from"./password-input-DE0wRYst.js";import{L as U}from"./loader-circle-CqpSi6VW.js";import{c as V}from"./createLucideIcon-CCBfe0vc.js";import"./newspaper-DWNG5Kd-.js";import"./index-C2uM0dkt.js";import"./request-2_miQ1pQ.js";import"./eye-Bvpb1x--.js";const $=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],q=V("log-in",$),z=k({username:l(),password:l().min(8,"密码至少8位")});function G({className:a,redirectTo:r,...g}){const[i,b]=m.useState(!1),o=F(),{auth:n}=L();m.useEffect(()=>{n.accessToken&&o({to:r||"/",replace:!0})},[n,o,r]);const t=_({resolver:H(z),defaultValues:{username:"",password:""}});async function N(e){b(!0);const c=await T(e);if(c.code===0){n.setAccessToken(c.data.access_token);const C=r||"/";u.success(`欢迎回来, ${e.username}!`),await o({to:C,replace:!0})}else u.error(c.message)}return s.jsx(B,{...t,children:s.jsxs("form",{onSubmit:t.handleSubmit(N),className:S("grid gap-3",a),...g,children:[s.jsx(p,{control:t.control,name:"username",render:({field:e})=>s.jsxs(h,{className:"relative",children:[s.jsx(x,{children:"用户名"}),s.jsx(j,{children:s.jsx(D,{placeholder:"",...e})}),s.jsx(f,{}),s.jsx(d,{to:"/sign-up",className:"absolute end-0 -top-0.5 text-sm font-medium text-muted-foreground hover:opacity-75",children:"首次登录?"})]})}),s.jsx(p,{control:t.control,name:"password",render:({field:e})=>s.jsxs(h,{className:"relative",children:[s.jsx(x,{children:"密码"}),s.jsx(j,{children:s.jsx(R,{placeholder:"********",...e})}),s.jsx(f,{}),s.jsx(d,{to:"/forgot-password",className:"absolute end-0 -top-0.5 text-sm font-medium text-muted-foreground hover:opacity-75",children:"忘记密码?"})]})}),s.jsxs(v,{className:"mt-2",disabled:i,children:[i?s.jsx(U,{className:"animate-spin"}):s.jsx(q,{}),"登入"]})]})})}function J(){const{redirect:a}=I({from:"/(auth)/sign-in"});return s.jsx(M,{children:s.jsxs(w,{className:"gap-4",children:[s.jsxs(y,{children:[s.jsx(A,{className:"text-lg tracking-tight",children:"登入"}),s.jsx(P,{})]}),s.jsx(E,{children:s.jsx(G,{redirectTo:a})})]})})}const cs=J;export{cs as component};
